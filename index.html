<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Katalog Produk - Sabit Store</title>
    
    <!-- Impor Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Impor Google Fonts (Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* Menggunakan font Inter sebagai default */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <!-- Kontainer utama diperlebar untuk menampung lebih banyak kolom -->
    <div class="w-full max-w-6xl mx-auto">
        <!-- Header -->
        <header class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl shadow-2xl mb-8 p-8 text-center overflow-hidden relative">
             <div class="absolute top-0 left-0 w-full h-full opacity-10" style="background-image: radial-gradient(#fff 1px, transparent 1px), radial-gradient(#fff 1px, transparent 1px); background-size: 20px 20px; background-position: 0 0, 10px 10px;"></div>
             <div class="relative z-10">
                <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight">Sabit Store</h1>
                <p class="mt-2 text-indigo-200 text-lg">Temukan Penawaran Terbaik Anda di Sini</p>
            </div>
        </header>

        <!-- Konten Katalog -->
        <main class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
            <!-- Fitur Live Search -->
            <div class="mb-8">
                <label for="search-input" class="sr-only">Cari Produk</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <input type="search" id="search-input" class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Cari nama produk...">
                </div>
            </div>

            <!-- Grid Produk. Class `grid-cols-2` memastikan 2 kolom di tampilan mobile. -->
            <div id="product-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-5">
                <!-- Kartu produk akan muncul di sini -->
                <p class="text-gray-500 col-span-full text-center" id="grid-placeholder">Memuat produk...</p>
            </div>
        </main>

        <!-- Bagian testimoni sudah dihapus dari sini -->
    </div>

    <!-- Footer -->
    <footer class="text-center text-sm text-gray-500 mt-8">
        <p>Made with ❤️ by Sabit Store</p>
    </footer>

    <!-- Modal untuk Ketentuan Garansi -->
    <div id="warranty-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4 z-50 transition-opacity duration-300">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full transform transition-all duration-300 scale-95">
            <div class="flex justify-between items-center mb-4 border-b pb-3">
                <h2 id="modal-title" class="text-xl font-bold"></h2>
                <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            </div>
            <div id="modal-body" class="text-sm text-gray-700 space-y-2 leading-relaxed">
            </div>
            <div class="text-right mt-6">
                <button id="close-modal-footer-btn" class="bg-indigo-600 text-white py-2 px-5 rounded-lg hover:bg-indigo-700 text-sm">Tutup</button>
            </div>
        </div>
    </div>


    <script>
        // --- KONFIGURASI AIRTABLE (SUDAH DIISI DENGAN DATA ANDA) ---
        const AIRTABLE_API_KEY = 'patJ0uIDkWsfmCJKX.0d5417fdca0e476f5a51d2cbd49fab6f9737b7ce6cd85e6587aca60f42744a94';
        const AIRTABLE_BASE_ID = 'appTUxg4WRc8E8dSy';
        const AIRTABLE_TABLE_NAME = 'Produk'; 

        const airtableUrl = `https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${encodeURIComponent(AIRTABLE_TABLE_NAME)}`;

        // --- LOGIKA JAVASCRIPT ---
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('search-input');
            const productGrid = document.getElementById('product-grid');
            const modal = document.getElementById('warranty-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const closeModalFooterBtn = document.getElementById('close-modal-footer-btn');

            let allProducts = []; 

            function openModal(warrantyText, productName) {
                modalTitle.textContent = `Garansi: ${productName}`;
                modalBody.innerHTML = `<p>${warrantyText.split(';').join(' ')}</p>`;
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                setTimeout(() => modal.querySelector('div').classList.remove('scale-95'), 10);
            }

            function closeModal() {
                 modal.querySelector('div').classList.add('scale-95');
                 setTimeout(() => {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                 }, 300);
            }
            
            closeModalBtn.addEventListener('click', closeModal);
            closeModalFooterBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (event) => {
                if (event.target === modal) {
                    closeModal();
                }
            });

            async function fetchAndDisplayProducts() {
                try {
                    const response = await fetch(airtableUrl, { headers: { Authorization: `Bearer ${AIRTABLE_API_KEY}` } });
                    if (!response.ok) throw new Error((await response.json()).error.message);
                    
                    const data = await response.json();
                    allProducts = data.records.map(record => ({ id: record.id, ...record.fields }));
                    displayProducts(allProducts);

                } catch (error) {
                    console.error('Gagal mengambil data dari Airtable:', error);
                    productGrid.innerHTML = `<p class="text-red-600 font-semibold text-center col-span-full">Gagal memuat data produk. <br>Penyebab: ${error.message}.</p>`;
                }
            }
            
            function displayProducts(products) {
                productGrid.innerHTML = '';
                if (products.length === 0) {
                     productGrid.innerHTML = `<p class="col-span-full text-center text-gray-500">Produk tidak ditemukan.</p>`;
                } else {
                     products.forEach(product => {
                        const card = createProductCard(product);
                        productGrid.appendChild(card);
                    });
                }
            }
            
            function handleSearch() {
                const searchTerm = searchInput.value.toLowerCase();
                const filteredProducts = allProducts.filter(product => 
                    product.Nama && product.Nama.toLowerCase().includes(searchTerm)
                );
                displayProducts(filteredProducts);
            }
            
            searchInput.addEventListener('input', handleSearch);

            function createProductCard(product) {
                const card = document.createElement('div');
                card.className = "bg-white rounded-lg shadow-md overflow-hidden transform hover:-translate-y-1 transition-all duration-300 flex flex-col";

                const imageUrl = (product.Gambar && product.Gambar.length > 0) ? product.Gambar[0].url : 'https://placehold.co/600x400/cccccc/ffffff?text=Tanpa+Gambar';
                const phoneNumber = '6283194168199';
                const message = encodeURIComponent(`Halo, saya tertarik dengan produk: ${product.Nama} dengan harga ${product.Harga}.`);
                const whatsappLink = `https://wa.me/${phoneNumber}?text=${message}`;

                let warrantyButtonHtml = '';
                if (product.Garansi && product.Garansi.trim() !== '') {
                    warrantyButtonHtml = `<button data-warranty="${product.Garansi}" data-product-name="${product.Nama || 'Produk'}" class="text-xs text-indigo-600 hover:text-indigo-800 font-semibold mt-2">Ketentuan Garansi</button>`;
                }
                
                card.innerHTML = `
                    <img class="w-full h-24 object-cover" src="${imageUrl}" alt="[Gambar dari ${product.Nama}]">
                    <div class="p-3 flex flex-col flex-grow">
                        <h3 class="font-bold text-base mb-1 text-gray-800 leading-tight">${product.Nama || 'N/A'}</h3>
                        <p class="text-gray-600 text-xs mb-2 flex-grow">${product.Deskripsi || ''}</p>
                        
                        <div class="space-y-1 text-xs">
                            <div class="flex justify-between items-center">
                                <span class="font-medium text-gray-700">Harga:</span>
                                <span class="font-bold text-base text-indigo-600">${product.Harga || 'N/A'}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="font-medium text-gray-700">Stok:</span>
                                <span class="font-semibold text-gray-800">${product.Stok || '0'}</span>
                            </div>
                        </div>

                        ${warrantyButtonHtml}

                        <div class="mt-auto pt-3 border-t border-gray-200">
                             <a href="${whatsappLink}" target="_blank" rel="noopener noreferrer" class="w-full flex items-center justify-center bg-green-500 text-white font-bold py-1.5 px-2 rounded-md hover:bg-green-600 transition duration-300 text-xs">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1.5" viewBox="0 0 24 24" fill="currentColor"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.61 15.34 3.48 16.81L2 22L7.33 20.55C8.75 21.35 10.35 21.81 12.04 21.81C17.5 21.81 21.95 17.36 21.95 11.91C21.95 6.45 17.5 2 12.04 2Z"/></svg>
                                Pesan
                            </a>
                        </div>
                    </div>
                `;

                const warrantyButton = card.querySelector('button[data-warranty]');
                if (warrantyButton) {
                    warrantyButton.addEventListener('click', () => {
                        openModal(warrantyButton.dataset.warranty, warrantyButton.dataset.productName);
                    });
                }
                
                return card;
            }

            fetchAndDisplayProducts();
        });
    </script>
</body>
</html>
